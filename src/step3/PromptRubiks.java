package step3;

import java.util.Scanner;

public class PromptRubiks {
	
	// 메소드: Rubiks Cube 전체 출력
	public void printResult(char[][][] threeDimensionalCube) {
		int BACK_SIDE = PushRubiksCube.BACK_SIDE;
		int UP_SIDE = PushRubiksCube.UP_SIDE;
		int LEFT_SIDE = PushRubiksCube.LEFT_SIDE;
		int DOWN_SIDE = PushRubiksCube.DOWN_SIDE;
		int RIGHT_SIDE = PushRubiksCube.RIGHT_SIDE;
		int FRONT_SIDE = PushRubiksCube.FRONT_SIDE;

		final int LENGTH_OF_CUBE = threeDimensionalCube[BACK_SIDE][0].length;

		// back side cube 출력
		for (char[] oneDimensionalCube : threeDimensionalCube[BACK_SIDE]) {
			System.out.print("                  ");
			for (char elementOfCube : oneDimensionalCube) {
				System.out.print(elementOfCube + " ");
			}
			System.out.println("");
		}
		System.out.println("");

		for (int i = 0; i < LENGTH_OF_CUBE; i++) {
			System.out.print("  ");

			// up side cube 출력
			for (char elementOfCube : threeDimensionalCube[UP_SIDE][i]) {
				System.out.print(elementOfCube + " ");
			}
			System.out.print("  ");

			// left side cube 출력
			for (char elementOfCube : threeDimensionalCube[LEFT_SIDE][i]) {
				System.out.print(elementOfCube + " ");
			}
			System.out.print("  ");

			// down side cube 출력
			for (char elementOfCube : threeDimensionalCube[DOWN_SIDE][i]) {
				System.out.print(elementOfCube + " ");
			}
			System.out.print("  ");

			// right side cube 출력
			for (char elementOfCube : threeDimensionalCube[RIGHT_SIDE][i]) {
				System.out.print(elementOfCube + " ");
			}
			System.out.println("");
		}
		System.out.println("");

		// front side cube 출력
		for (char[] oneDimensionalCube : threeDimensionalCube[FRONT_SIDE]) {
			System.out.print("                  ");
			for (char elementOfCube : oneDimensionalCube) {
				System.out.print(elementOfCube + " ");
			}
			System.out.println("");
		}
		System.out.println("");
	}

	// 메소드: 사용자 입력값을 유효한 명령으로 나누어 반환
	public String[] splitInputString(String input) {

		StringBuffer inputSplit = new StringBuffer(input);
		int indexOfSplit = 1;

		// String input의 각 문자에 대해 순회
		for (int i = 0; i < input.length() - 1; i++) {
			// 작은따옴표 or '2' or '3'이 있는 경우, 해당 문자 기준 우측에 공백 문자 삽입
			if (input.charAt(i + 1) == 39 || input.charAt(i + 1) == 50 || input.charAt(i + 1) == 51) {
				indexOfSplit += 1;
				inputSplit.insert(indexOfSplit, " ");
				i++;
				indexOfSplit += 2;
				// 일반 문자일 경우, 다음 문자에 작은 따옴표가 없다면 문자 기준 우측에 공백 문자 삽입
			} else {
				inputSplit.insert(indexOfSplit, " ");
				indexOfSplit += 2;
			}
		}
		return new String(inputSplit).split(" ");
	}
	
	// 메소드: 조작 개수 카운트
	public int countRotation(int count, String input) {
		
		if(input.contains("2")) {
			count += 2;
		} else if(input.contains("3")) {
			count += 3;
		} else {
			count += 1;
		}
		
		return count;
	}
	
	// 메소드: 사용자 입력값 받고 결과물 출력
	public void executePrompt(char[][][] rubiksCube) {
		Scanner scanner = new Scanner(System.in);
		PushRubiksCube pushRubiks = new PushRubiksCube();
		int numOfRotation = 0;
		// 초기값 출력
		printResult(rubiksCube);

		while (true) {
			// 사용자 입력
			System.out.print("  CUBE> ");
			String input = scanner.nextLine();

			// 실행 중단
			if (input.equals("Q"))
				break;

			// inputSplit에 대해 공백문자 기준으로 분할하여 모든 명령어를 String array에 할당
			String[] splitStringArray = splitInputString(input);
			for (String inputDir : splitStringArray) {
				
				numOfRotation = countRotation(numOfRotation, inputDir);
				
				System.out.println("");
				System.out.println("  " + inputDir);

				rubiksCube = pushRubiks.getPushedRubiks(rubiksCube, inputDir);

				// 결과값 출력
				printResult(rubiksCube);

			}
		}
		// 조작개수 출력
		System.out.println("  조작개수: " + numOfRotation);
		System.out.println("  끝~ ");
		scanner.close();
	}

	public static void main(String[] args) {
		char[][] frontCube = { { 'G', 'G', 'G' }, { 'G', 'G', 'G' }, { 'G', 'G', 'G' } };
		char[][] upCube = { { 'W', 'W', 'W' }, { 'W', 'W', 'W' }, { 'W', 'W', 'W' } };
		char[][] leftCube = { { 'O', 'O', 'O' }, { 'O', 'O', 'O' }, { 'O', 'O', 'O' } };
		char[][] downCube = { { 'Y', 'Y', 'Y' }, { 'Y', 'Y', 'Y' }, { 'Y', 'Y', 'Y' } };
		char[][] rightCube = { { 'R', 'R', 'R' }, { 'R', 'R', 'R' }, { 'R', 'R', 'R' } };
		char[][] backCube = { { 'B', 'B', 'B' }, { 'B', 'B', 'B' }, { 'B', 'B', 'B' } };

		char[][][] rubiksCube = { backCube, upCube, leftCube, downCube, rightCube, frontCube };

		PromptRubiks prompt = new PromptRubiks();

		prompt.executePrompt(rubiksCube);

	}

}
